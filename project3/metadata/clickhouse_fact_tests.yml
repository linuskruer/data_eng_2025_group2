source:
  type: testSuite
  serviceName: clickhouse_project3
  serviceConnection:
    config:
      type: Clickhouse
      hostPort: clickhouse-server:8123
      databaseSchema: default
      username: default
      password: mypassword
  sourceConfig:
    config:
      type: TestSuite
      entityFullyQualifiedName: clickhouse_project3.default.default.fact_listings

processor:
  type: test-case-runner
  config:
    forceUpdate: true
    testCases:
      - name: "Test 1: Foreign Key Not Null"
        displayName: "Test 1: Foreign Key Not Null"
        description: "Fails when any fact_listings row has a NULL product_type reference."
        testDefinitionName: tableCustomSQLQuery
        parameterValues:
          - name: sqlExpression
            value: |
              SELECT item_id
              FROM default.fact_listings
              WHERE product_type IS NULL
      - name: "Test 3: Feedback Percentage Range"
        displayName: "Test 3: Feedback Percentage Range"
        description: "Ensures seller_feedback_percentage stays within 0-100 inclusive."
        testDefinitionName: tableCustomSQLQuery
        parameterValues:
          - name: sqlExpression
            value: |
              SELECT item_id, seller_feedback_percentage
              FROM default.fact_listings
              WHERE seller_feedback_percentage < 0 OR seller_feedback_percentage > 100

sink:
  type: metadata-rest
  config: {}

workflowConfig:
  openMetadataServerConfig:
    hostPort: http://openmetadata-server:8585/api
    authProvider: openmetadata
    securityConfig:
      jwtToken: "eyJraWQiOiJHYjM4OWEtOWY3Ni1nZGpzLWE5MmotMDI0MmJrOTQzNTYiLCJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJvcGVuLW1ldGFkYXRhLm9yZyIsInN1YiI6ImFkbWluIiwicm9sZXMiOlsiQWRtaW4iXSwiZW1haWwiOiJhZG1pbkBvcGVubWV0YWRhdGEub3JnIiwiaXNCb3QiOmZhbHNlLCJ0b2tlblR5cGUiOiJQRVJTT05BTF9BQ0NFU1MiLCJpYXQiOjE3NjQzMjAzNzMsImV4cCI6MTc2NDQwNjc3M30.wnuw254w4DsRoPQ-L1OF7PTZYZ4znr-x0o3jGqPst2w5ZFC6qi_pP9gtyPHVrvafHYnz97rzQ0tbNhnYjEFZkAP5HEf5_NI15bZ7D62SVQkMNDKS5tME0gsQ26obenrnmbnk7clz6GkNOnM_CnAXi626Hh0fhToPN9TZeQMDthbIdjn9HzKEuB_n-Fe5EPU_WyQDpKuvt6g1P7pZVjwso1Dm9dHx-SUOw6RMhx32uGn2rJfTSC_He2gK9hJzzP1TP-oSLK7QcG8pZWfLXe9exxdEMKJJjh6JK4xtu6ZZjCZFjLpnNL-CwFpU-csJc5grYfn9NvHvm9G8nYhAwJqF-Q"

